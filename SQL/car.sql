CREATE DATABASE CAR;
USE CAR;
CREATE TABLE owners(
owner_id VARCHAR(10),
owner_name VARCHAR(20),
address VARCHAR(20),
phone_no BIGINT,
email_id VARCHAR(20),
PRIMARY KEY(owner_id)
);
CREATE TABLE CUSTOMERS(
customer_id VARCHAR(10),
customerr_name VARCHAR(20),
address VARCHAR(20),
phone_no BIGINT,
email_id VARCHAR(20),
PRIMARY KEY(customer_id)
);
CREATE TABLE CARS(
car_id VARCHAR(10),
car_name VARCHAR(20),
car_type VARCHAR(20),
owner_id VARCHAR(10),
PRIMARY KEY(car_id)
);
CREATE TABLE RENTALS(
rental_id VARCHAR(10),
customer_id VARCHAR(10),
car_id VARCHAR(10),
pickdate DATE,
return_date VARCHAR(20),
km_driven INT,
fare_amount DOUBLE(10,2),
PRIMARY KEY(rental_id)
);

INSERT INTO OWNERS
VALUES('A','SAM','ABC',988776656,'SAM@GMAIL.COM');
INSERT INTO OWNERS
VALUES('B','SAMU','ABCD',988776658,'SAMU@GMAIL.COM');
INSERT INTO OWNERS
VALUES('C','SAMYU','ABCDE',988776659,'SAMYU@GMAIL.COM');
INSERT INTO OWNERS
VALUES('D','SAMMY','ABCDEF',988776686,'SAMMY@GMAIL.COM');
INSERT INTO OWNERS
VALUES('E','SON','AB',988773356,'SON@GMAIL.COM');
INSERT INTO OWNERS
VALUES('F','SONA','ABCF',9887819656,'SONA@GMAIL.COM');

INSERT INTO CARS
VALUES('V008','MARUTI','XYX','A');
INSERT INTO CARS
VALUES('V007','SWIFT','XY','B');
INSERT INTO CARS
VALUES('V003','BMW','XYZ','C');
INSERT INTO CARS
VALUES('V001','POLO','XYA','D');
INSERT INTO CARS
VALUES('V005','FORD','XYB','E');
INSERT INTO CARS
VALUES('V006','maruti','XYC','f');
INSERT INTO CARS
VALUES('V002','NANO','HATCHBACK','G');
INSERT INTO CARS
VALUES('V002','MARUTI','XYL','h',9098878);
DELETE  FROM CARS
WHERE car_id='V002';
SELECT * FROM OWNERS;

INSERT INTO CUSTOMERS
VALUES('C007','ATHU','KKM','466788980','ATHU@GMAIL.COM');
INSERT INTO CUSTOMERS
VALUES('C001','ATHULYA','TSR','23455667','ATHULYA@GMAIL.COM');
INSERT INTO CUSTOMERS
VALUES('C008','ATHUL','KZR','122356768','ATHUL@GMAIL.COM');
INSERT INTO CUSTOMERS
VALUES('C009','NAZ','TVM','55798098','NAZ@GMAIL.COM');
INSERT INTO CUSTOMERS
VALUES('C003','NAZNI','KLR','6788980','NAZNI@GMAIL.COM');
INSERT INTO CUSTOMERS
VALUES('C006','NAZNIN','KZM','45566890','NAZNIN@GMAIL.COM');


INSERT INTO RENTALS
VALUES('R001','C007','V004','2018-03-10','2018-03-10',800,9000);
INSERT INTO RENTALS
VALUES('R002','C001','V007','2018-03-11','2018-03-12',200,3000);
INSERT INTO RENTALS
VALUES('R003','C002','V003','2018-04-15','AUGUST 2019',100,1500);
INSERT INTO RENTALS
VALUES('R004','C003','V001','2018-05-16','2018-05-18',1000,10000);
INSERT INTO RENTALS
VALUES('R000','C001','V001','2018-03-11','2018-03-12',200,3000);
delete from rentals
where rental_id='r005';



SELECT car_id,car_name,car_type FROM CARS
WHERE car_id NOT IN (SELECT car_id FROM RENTALS)
ORDER BY car_id;

SELECT car_id,car_name,owner_id FROM CARS
WHERE car_type='hatchback' OR 'Suv'
ORDER BY car_id;

ALTER TABLE CARS
ADD CAR_REGNO VARCHAR(10);
SELECT * FROM CARS;
DESC CARS;

SELECT  car_name,car_id,car_type FROM CARS
WHERE car_name='maruti' AND car_type='xyx'
ORDER BY car_id;


SELECT DISTINCT (o.owner_id),o.owner_name,o.address,o.phone_no FROM  OWNERS O 
JOIN CARS C ON o.OWNER_ID=C.OWNER_ID
WHERE C.CAR_NAME LIKE 'MARUTI%'
GROUP BY o.OWNER_ID;

select distinct owner_id,owner_name,address,phone_no from  CARS
CROSS JOIN OWNERS
WHERE CAR_NAME='MARUTI';

select km_driven,car_ID,RENTAL_ID,CUSTOMER_ID from Rentals
where return_date LIKE '%AUGUST 2019%';

select car_id,count(CAR_ID) AS NO_OF_TRIPS FROM RENTALS
GROUP BY CAR_ID ;
















